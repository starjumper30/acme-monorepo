<div class="movie-list-header">
  <mat-form-field
    appearance="outline"
    class="inline-form-field mat-mdc-paginator"
  >
    <mat-label>Genre</mat-label>
    <mat-select [formControl]="selectedGenre">
      <mat-option>--</mat-option>
      @for (genre of genres(); track genre.title) {
      <mat-option [value]="genre.title">{{genre.title}}</mat-option>
      }
    </mat-select>
  </mat-form-field>
  <mat-paginator
    [length]="totalMovies()"
    [pageSize]="pageSettings().perPage"
    [pageSizeOptions]="[6, 9, 30, 99]"
    [pageIndex]="pageSettings().page - 1"
    (page)="onPageChange($event)"
    aria-label="Select page"
  >
  </mat-paginator>
  <div>
    <button
      matIconButton
      [disabled]="viewType === 'card'"
      (click)="viewType = 'card'; $event.stopPropagation()"
    >
      <mat-icon>grid_view</mat-icon>
    </button>
    <button
      matIconButton
      [disabled]="viewType === 'table'"
      (click)="viewType = 'table'; $event.stopPropagation()"
    >
      <mat-icon>table_view</mat-icon>
    </button>
    <button
      matTooltip="Select a genre and a movie to get recommendations from Gemini"
      matIconButton
      [disabled]="!selectedGenre.value || !selectedMovie"
      [style.pointer-events]="'all'"
      (click)="getRecommendations()"
    >
      <mat-icon>assistant</mat-icon>
    </button>
  </div>
  @if(genresLoadingError()) {
  <mat-error>{{genresLoadingError()?.message}}</mat-error>
  } @if (isLoadingMovies()) {
  <p>Loading movies...</p>
  } @else if (moviesLoadingError()){ {{moviesLoadingError()?.message}} }
</div>

@if (viewType === 'card') {
<acme-movie-card-list
  [movies]="movies()"
  [selectedGenre]="selectedGenre.value ?? ''"
  [(selectedMovie)]="selectedMovie"
/>
} @else if (viewType === 'table') {
<acme-movie-table
  [movies]="movies()"
  [selectedGenre]="selectedGenre.value ?? ''"
  [(selectedMovie)]="selectedMovie"
/>
} @else if (viewType === 'recommendations') { {{recommendationsMessage()}}
<acme-movie-card-list
  [movies]="recommendations() ?? []"
  [selectedGenre]="selectedGenre.value ?? ''"
  [highlightSelected]="false"
/>
}
